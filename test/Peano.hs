(fromList [("Peano",TyAlg "Peano" [("Zero",1,TyConApp "Peano" [],[]),("Succ",2,TyConApp "Peano" [],[TyConApp "Peano" []])])],fromList [("a",Lam "ds" (Case (Var "ds" (TyConApp "Int" [])) [((("I#",1,TyConApp "Int" [],[TyConApp "Int#" []]),["ds1"]),Case (Var "ds1" (TyConApp "Int#" [])) [((("DEFAULT",0,TyBottom,[]),[]),App (App (App (App (Var "+" (TyForAll "a" (TyFun (TyConApp "Num" [TyVar "a"]) (TyFun (TyVar "a") (TyFun (TyVar "a") (TyVar "a")))))) (Type (TyConApp "Int" []))) (Var "$fNumInt" (TyConApp "Num" [TyConApp "Int" []]))) (App (Var "b" (TyFun (TyConApp "Int" []) (TyConApp "Int" []))) (App (Var "I#" (TyFun (TyConApp "Int#" []) (TyConApp "Int" []))) (Const (CInt 1))))) (App (Var "I#" (TyFun (TyConApp "Int#" []) (TyConApp "Int" []))) (Const (CInt 2)))),((("Int!",-1,TyConApp "Int" [],[TyRawInt]),[]),App (Var "I#" (TyFun (TyConApp "Int#" []) (TyConApp "Int" []))) (Const (CInt 0)))] (TyConApp "Int" []))] (TyConApp "Int" [])) (TyConApp "Int" [])),("add",Lam "ds" (Lam "b1" (Case (Var "ds" (TyConApp "Peano" [])) [((("Zero",1,TyConApp "Peano" [],[]),[]),Var "b1" (TyConApp "Peano" [])),((("Succ",2,TyConApp "Peano" [],[TyConApp "Peano" []]),["a1"]),App (Var "Succ" (TyFun (TyConApp "Peano" []) (TyConApp "Peano" []))) (App (App (Var "add" (TyFun (TyConApp "Peano" []) (TyFun (TyConApp "Peano" []) (TyConApp "Peano" [])))) (Var "a1" (TyConApp "Peano" []))) (Var "b1" (TyConApp "Peano" []))))] (TyConApp "Peano" [])) (TyConApp "Peano" [])) (TyConApp "Peano" [])),("b",Lam "ds" (Case (Var "ds" (TyConApp "Int" [])) [((("I#",1,TyConApp "Int" [],[TyConApp "Int#" []]),["ds1"]),Case (Var "ds1" (TyConApp "Int#" [])) [((("DEFAULT",0,TyBottom,[]),[]),App (App (App (App (Var "+" (TyForAll "a" (TyFun (TyConApp "Num" [TyVar "a"]) (TyFun (TyVar "a") (TyFun (TyVar "a") (TyVar "a")))))) (Type (TyConApp "Int" []))) (Var "$fNumInt" (TyConApp "Num" [TyConApp "Int" []]))) (App (App (App (App (Var "+" (TyForAll "a" (TyFun (TyConApp "Num" [TyVar "a"]) (TyFun (TyVar "a") (TyFun (TyVar "a") (TyVar "a")))))) (Type (TyConApp "Int" []))) (Var "$fNumInt" (TyConApp "Num" [TyConApp "Int" []]))) (App (Var "b" (TyFun (TyConApp "Int" []) (TyConApp "Int" []))) (App (Var "I#" (TyFun (TyConApp "Int#" []) (TyConApp "Int" []))) (Const (CInt 1))))) (App (Var "I#" (TyFun (TyConApp "Int#" []) (TyConApp "Int" []))) (Const (CInt 2))))) (App (Var "I#" (TyFun (TyConApp "Int#" []) (TyConApp "Int" []))) (Const (CInt 1)))),((("Int!",-1,TyConApp "Int" [],[TyRawInt]),[]),App (Var "I#" (TyFun (TyConApp "Int#" []) (TyConApp "Int" []))) (Const (CInt 1)))] (TyConApp "Int" []))] (TyConApp "Int" [])) (TyConApp "Int" [])),("hue",App (App (Var "head" (TyForAll "a" (TyFun (TyConApp "[]" [TyVar "a"]) (TyVar "a")))) (Type (TyConApp "Integer" []))) (App (App (App (Var "enumFrom" (TyForAll "a" (TyFun (TyConApp "Enum" [TyVar "a"]) (TyFun (TyVar "a") (TyConApp "[]" [TyVar "a"]))))) (Type (TyConApp "Integer" []))) (Var "$fEnumInteger" (TyConApp "Enum" [TyConApp "Integer" []]))) (Const (CInt 1))))])
Compiles!
