fromList [("Bool",TyAlg "Bool" [("True",-5,TyConApp "Bool" [],[]),("False",-6,TyConApp "Bool" [],[])]),("Char",TyAlg "Char" [("Char!",-4,TyConApp "Char" [],[TyChar])]),("Double",TyAlg "Double" [("Double!",-3,TyConApp "Double" [],[TyReal])]),("Float",TyAlg "Float" [("Float!",-2,TyConApp "Float" [],[TyReal])]),("Int",TyAlg "Int" [("Int!",-1,TyConApp "Int" [],[TyInt])]),("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt)
[]
==============================================
fromList [("Bool",TyAlg "Bool" [("True",-5,TyConApp "Bool" [],[]),("False",-6,TyConApp "Bool" [],[])]),("Char",TyAlg "Char" [("Char!",-4,TyConApp "Char" [],[TyChar])]),("Double",TyAlg "Double" [("Double!",-3,TyConApp "Double" [],[TyReal])]),("Float",TyAlg "Float" [("Float!",-2,TyConApp "Float" [],[TyReal])]),("Int",TyAlg "Int" [("Int!",-1,TyConApp "Int" [],[TyInt])]),("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("aa",App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt)),("aaaa",App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)),("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("ba",App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt))),("baaa",App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt)),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]

>>> App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt))))
                  (Const (CInt 123) TyInt))
             (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))
        (Const (CInt 456) TyInt)

[(App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)),(("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["baaa","aaaa"])),(App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt)),(("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["ba","aa"]))]
Compiles!
