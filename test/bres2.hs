fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt
[]
==============================================
1
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 123) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Leaf",1,TyConApp "Tree" [],[TyInt]),["aa"]))]
--------------
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 456) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["ba","aa"]))]
==============================================
2
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 123) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Leaf",1,TyConApp "Tree" [],[TyInt]),["aa"]))]
--------------
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 456) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["ba","aa"]))]
==============================================
3
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 123) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Leaf",1,TyConApp "Tree" [],[TyInt]),["aa"]))]
--------------
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 456) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["ba","aa"]))]
==============================================
4
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 123) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Leaf",1,TyConApp "Tree" [],[TyInt]),["aa"]))]
--------------
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 456) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["ba","aa"]))]
==============================================
5
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 123) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Leaf",1,TyConApp "Tree" [],[TyInt]),["aa"]))]
--------------
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 456) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["ba","aa"]))]
==============================================
6
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 123) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Leaf",1,TyConApp "Tree" [],[TyInt]),["aa"]))]
--------------
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 456) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["ba","aa"]))]
==============================================
7
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 123) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Leaf",1,TyConApp "Tree" [],[TyInt]),["aa"]))]
--------------
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 456) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["ba","aa"]))]
==============================================
8
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 123) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Leaf",1,TyConApp "Tree" [],[TyInt]),["aa"]))]
--------------
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 456) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["ba","aa"]))]
==============================================
9
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 123) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Leaf",1,TyConApp "Tree" [],[TyInt]),["aa"]))]
--------------
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 456) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["ba","aa"]))]
==============================================
10
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 123) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Leaf",1,TyConApp "Tree" [],[TyInt]),["aa"]))]
--------------
fromList [("Tree",TyAlg "Tree" [("Leaf",1,TyConApp "Tree" [],[TyInt]),("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []])])]
fromList [("abstract",Case (App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt)) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Const (CInt 123) TyInt),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Const (CInt 456) TyInt)] TyInt),("inner",Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("outer",Case (Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),Case (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))) [((("Leaf",1,TyConApp "Tree" [],[TyInt]),["a"]),App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (App (DCon ("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]) (TyConApp "Tree" [])) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "a" TyInt))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "b" TyInt)))) (App (DCon ("Leaf",1,TyConApp "Tree" [],[TyInt]) (TyConApp "Tree" [])) (Var "c" TyInt))),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "a" (TyConApp "Tree" []))] (TyConApp "Tree" [])),((("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["a","b"]),Var "b" (TyConApp "Tree" []))] (TyConApp "Tree" [])),("test",App (App (App (Var "foo" (TyFun TyInt (TyFun (TyConApp "Tree" []) (TyFun TyInt TyInt)))) (Const (CInt 123) TyInt)) (Var "outer" (TyConApp "Tree" []))) (Const (CInt 456) TyInt))]
Const (CInt 456) TyInt
[(App (App (Var "a" (TyFun TyInt (TyFun TyInt (TyConApp "Tree" [])))) (Var "b" TyInt)) (Var "c" TyInt),(("Node",2,TyConApp "Tree" [],[TyConApp "Tree" [],TyConApp "Tree" []]),["ba","aa"]))]
==============================================
Compiles!
